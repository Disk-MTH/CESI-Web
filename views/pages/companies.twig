{% set title = "Stagify - Entreprises" %}
{% set alternative_search_bar = true %}
{% set pagination = true %}
{% extends "components/layouts/layout.twig" %}

{% block templates %}
    {{ include("components/tiles/company_tile.twig") }}
{% endblock %}

{% block header %}
    <section class="bg-deepWarmGrey ">
        <div class="container py-3">
            <div class="row ">
                <div class="col-8">
                    <div class="pt-2">Recherche d'entreprises</div>
                </div>
                <div class="col-4 text-end">
                    <div class="dropdown dropdown-menu-end">
                        <div class="btn btn-deepWarmGrey shadow" data-bs-toggle="dropdown"
                             data-bs-target="#dropdownMenuButton">
                            <img src="/assets/svg/misc/sliders.svg" alt="slider"> Filtres
                        </div>
                        {{ include("components/filters/company_filter.twig") }}
                    </div>
                </div>
            </div>
        </div>
    </section>
{% endblock %}

{% block content %}
    <section>
        <div class="container pt-4">
            <div class="row" id="companies"></div>
        </div>
    </section>
{% endblock %}


{% block scripting %}
    <script>
        (async function () {
            $("#pagination").pagination({
                count: Math.ceil((await fetch("/companies?count=true").then(response => response.json().then(data => data)))["count"] / 12),
                maxVisible: 5,
            }).on("changePage", function (event, page) {
                const element = $("#companies");
                setLoading(element);
                retrieve(element, $("#companyTile"), `/companies/${page}`);
            }).trigger("changePage", 1);
        })();
    </script>
{% endblock %}